{% extends 'base.html' %}

{% block title %} {{ name }} {% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Meal Period Selection -->
    <div class="row justify-content-center text-center mb-5" id="meal-selection">
        <div class="col">
            <h1 class="display-5 fw-light mb-3 slide-up-from-bottom">{{ name }}</h1>
            <h2 class="h5 text-muted mb-5 slide-up-delay-1" id="prompt">Choose your Meal Period</h2>
            
            <div class="dropdown-center slide-up-delay-2" id="mealperiods-dropdown">
                <button class="btn btn-secondary dropdown-toggle btn-lg" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Select Meal Period
                </button>
                <ul class="dropdown-menu dropdown-menu-dark" id="mealperiods">
                </ul>
            </div>
        </div>
    </div>

    <!-- Food Selection Form -->
    <div id="foodStuff" class="d-none">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-8">
                <div class="main-card">
                    <h2 class="h4 mb-4 text-center">Select Your Food Items</h2>
                    <form id="foodForm" action="/result" method="POST">
                        <div id="fooditems" class="mb-4">
                            <!-- Food items will be populated here -->
                        </div>
                    </form>
                    
                    <div class="text-center">
                        <button form="foodForm" type="submit" class="btn btn-primary btn-lg px-5">
                            Calculate My Macros
                        </button>
                        <p class="mt-3 small text-muted">
                            <em>*Each serving size is equivalent to 1 piece/slice/scoop</em>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Call the fetchData function when the page loads or when needed
    $(document).ready(function () {
        fetchMealperiods("{{ data_name }}");
        $('#mealperiods').on('click', '.dropdown-item', function (event) {
            event.preventDefault();

            // Get the selected meal period
            var selectedMealPeriod = $(this).text();

            // Update the page content based on the selected meal period
            fetchFoodItems(selectedMealPeriod, "{{ data_name }}");
        });
    });
</script>

{% endblock %}

