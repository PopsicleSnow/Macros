{% extends 'base.html' %}

{% block title %} {{ name }} {% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Meal Period Selection -->
    <div class="row justify-content-center text-center mb-5" id="meal-selection">
        <div class="col">
            <h1 class="display-5 fw-light mb-3 slide-up-from-bottom">{{ name }}</h1>
            <h2 class="h5 text-muted mb-5 slide-up-delay-1" id="prompt">Choose your Meal Period</h2>

            <div class="slide-up-delay-2">
                <div class="mealperiods-grid" id="mealperiods">
                    <!-- Meal period buttons will be populated here -->
                </div>
            </div>
            {% if data_name == 'browns' %}
            <p class="mt-4 small text-warning">
                <em>Note: Browns info may be inaccurate because we are awaiting data from Berkeley Dining.</em>
            </p>
            {% endif %}
        </div>
    </div>

    <!-- Food Selection Form -->
    <div id="foodStuff" class="d-none">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-8">
                <div class="main-card">
                    <h2 class="h4 mb-4 text-center">Select Your Food Items</h2>
                    <form id="foodForm" action="/result" method="POST">
                        <div id="fooditems" class="mb-4">
                            <!-- Food items will be populated here -->
                        </div>
                    </form>
                    
                    <div class="text-center">
                        <button form="foodForm" type="submit" class="btn btn-primary btn-lg px-5">
                            Calculate My Macros
                        </button>
                        <p class="mt-3 small text-muted">
                            <em>*Each serving size is equivalent to 1 piece/slice/scoop</em>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Call the fetchData function when the page loads or when needed
    $(document).ready(function () {
        fetchMealperiods("{{ data_name }}");
        $('#mealperiods').on('click', '.mealperiod-card', function (event) {
            event.preventDefault();

            // Get the selected meal period
            var selectedMealPeriod = $(this).data('mealperiod');

            // Update the page content based on the selected meal period
            fetchFoodItems(selectedMealPeriod, "{{ data_name }}");
        });
    });
</script>

{% endblock %}

